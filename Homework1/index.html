<!-- index.html -->
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Titanic EDA (Train+Test) — Browser-only</title>

  <!-- CDN libs -->
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>

  <style>
    :root{
      --bg:#0b0f19;
      --panel:#111827;
      --panel2:#0f172a;
      --text:#e5e7eb;
      --muted:#9ca3af;
      --border:#243044;
      --accent:#60a5fa;
      --ok:#34d399;
      --warn:#fbbf24;
      --bad:#f87171;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      background:linear-gradient(180deg, var(--bg), #070a12 60%);
      color:var(--text);
      font-family:var(--sans);
    }
    header{
      padding:18px 16px;
      border-bottom:1px solid var(--border);
      background:rgba(17,24,39,.75);
      position:sticky; top:0; backdrop-filter: blur(10px);
      z-index:10;
    }
    header h1{margin:0;font-size:18px;letter-spacing:.2px}
    header p{margin:6px 0 0;color:var(--muted);font-size:13px}
    main{
      max-width:1200px;
      margin:0 auto;
      padding:16px;
      display:grid;
      grid-template-columns: 1fr;
      gap:14px;
    }
    .grid-2{
      display:grid;
      grid-template-columns: 1fr;
      gap:14px;
    }
    @media (min-width: 980px){
      .grid-2{grid-template-columns: 1fr 1fr;}
    }

    section{
      border:1px solid var(--border);
      border-radius:14px;
      background:linear-gradient(180deg, rgba(17,24,39,.95), rgba(15,23,42,.9));
      overflow:hidden;
      box-shadow: 0 10px 35px rgba(0,0,0,.22);
    }
    .sec-h{
      padding:12px 14px;
      border-bottom:1px solid var(--border);
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
    }
    .sec-h h2{margin:0;font-size:14px}
    .sec-h .hint{color:var(--muted);font-size:12px}
    .sec-b{padding:14px}
    .row{
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      align-items:center;
    }
    label{
      font-size:12px;
      color:var(--muted);
      display:flex;
      flex-direction:column;
      gap:6px;
      min-width:220px;
    }
    input[type="file"], input[type="text"]{
      width:100%;
      padding:10px 10px;
      border-radius:10px;
      border:1px solid var(--border);
      background:rgba(8,11,20,.65);
      color:var(--text);
    }
    .btns{display:flex;gap:10px;flex-wrap:wrap}
    button{
      cursor:pointer;
      border:1px solid var(--border);
      background:rgba(96,165,250,.14);
      color:var(--text);
      padding:10px 12px;
      border-radius:12px;
      font-weight:600;
      letter-spacing:.15px;
    }
    button:hover{border-color:rgba(96,165,250,.6)}
    button:disabled{
      opacity:.55; cursor:not-allowed;
      border-color:var(--border);
    }
    .pill{
      font-size:12px;
      padding:6px 10px;
      border-radius:999px;
      border:1px solid var(--border);
      color:var(--muted);
      background:rgba(8,11,20,.55);
      font-family:var(--mono);
    }
    .status{
      display:flex; gap:8px; flex-wrap:wrap; align-items:center;
    }
    .status .ok{color:var(--ok)}
    .status .warn{color:var(--warn)}
    .status .bad{color:var(--bad)}
    .mono{font-family:var(--mono)}
    .small{font-size:12px;color:var(--muted);line-height:1.35}
    .kvs{
      display:grid;
      grid-template-columns: repeat(2, minmax(0,1fr));
      gap:10px;
      margin-top:12px;
    }
    @media (min-width: 700px){
      .kvs{grid-template-columns: repeat(4, minmax(0,1fr));}
    }
    .kv{
      border:1px solid var(--border);
      border-radius:12px;
      padding:10px;
      background:rgba(8,11,20,.45);
    }
    .kv .k{color:var(--muted);font-size:11px}
    .kv .v{font-size:16px;margin-top:6px;font-family:var(--mono)}
    .table-wrap{overflow:auto;border:1px solid var(--border);border-radius:12px}
    table{
      width:100%;
      border-collapse:collapse;
      font-size:12px;
      min-width:720px;
    }
    th, td{
      padding:8px 10px;
      border-bottom:1px solid rgba(36,48,68,.7);
      vertical-align:top;
      white-space:nowrap;
    }
    th{
      text-align:left;
      color:#cbd5e1;
      background:rgba(8,11,20,.6);
      position:sticky; top:0;
    }
    tr:hover td{background:rgba(96,165,250,.06)}
    .two-cols{
      display:grid;
      grid-template-columns: 1fr;
      gap:12px;
    }
    @media (min-width: 980px){
      .two-cols{grid-template-columns: 1fr 1fr;}
    }
    .canvas-wrap{
      border:1px solid var(--border);
      border-radius:12px;
      padding:10px;
      background:rgba(8,11,20,.45);
    }
    .note{
      margin-top:10px;
      padding:10px 12px;
      border-radius:12px;
      border:1px dashed rgba(96,165,250,.45);
      color:var(--muted);
      font-size:12px;
      line-height:1.4;
    }
    .footer{
      padding:0 16px 18px;
      max-width:1200px;
      margin:0 auto;
      color:var(--muted);
      font-size:12px;
    }
    code{font-family:var(--mono);color:#cbd5e1}
  </style>
</head>

<body>
<header>
  <h1>Titanic EDA — Train + Test merged (browser-only)</h1>
  <p>Auto-loads <code>./train.csv</code> + <code>./test.csv</code> from the repo by default. Optional file inputs can override.</p>
</header>

<main>
  <!-- Data Load -->
  <section>
    <div class="sec-h">
      <h2>1) Data Load</h2>
      <div class="status" id="loadStatus">
        <span class="pill">ready</span>
      </div>
    </div>
    <div class="sec-b">
      <div class="row">
        <label>
          Train CSV URL (default)
          <input id="trainUrl" type="text" value="./train.csv" />
        </label>
        <label>
          Test CSV URL (default)
          <input id="testUrl" type="text" value="./test.csv" />
        </label>
        <div class="btns">
          <button id="btnLoad">Load & Merge</button>
          <button id="btnRun" disabled>Run EDA</button>
          <button id="btnExportCsv" disabled>Export merged CSV</button>
          <button id="btnExportJson" disabled>Export JSON summary</button>
        </div>
      </div>

      <div class="row" style="margin-top:12px">
        <label>
          Optional override: train.csv file
          <input id="trainFile" type="file" accept=".csv,text/csv" />
        </label>
        <label>
          Optional override: test.csv file
          <input id="testFile" type="file" accept=".csv,text/csv" />
        </label>
      </div>

      <div class="note">
        Deployment note: Create a <b>public GitHub repo</b>, commit <code>index.html</code>, <code>app.js</code>, plus <code>train.csv</code> and <code>test.csv</code> in the repo root.
        Then enable <b>GitHub Pages</b> (Settings → Pages → Deploy from branch: <b>main</b>, folder: <b>/ (root)</b>). Open the Pages URL to test.
      </div>
    </div>
  </section>

  <!-- Merge & Overview -->
  <section>
    <div class="sec-h">
      <h2>2) Merge & Overview</h2>
      <div class="hint">Preview + shape + columns</div>
    </div>
    <div class="sec-b">
      <div class="kvs" id="overviewKvs"></div>

      <div style="margin-top:12px" class="small">
        Schema used (swap in <code>app.js</code> to reuse for other datasets): target <code>Survived</code> (train only), features
        <code>Pclass</code>, <code>Sex</code>, <code>Age</code>, <code>SibSp</code>, <code>Parch</code>, <code>Fare</code>, <code>Embarked</code>; identifier <code>PassengerId</code> (excluded).
      </div>

      <div style="margin-top:12px" class="table-wrap">
        <table id="previewTable">
          <thead></thead>
          <tbody></tbody>
        </table>
      </div>
    </div>
  </section>

  <div class="grid-2">
    <!-- Missing Values -->
    <section>
      <div class="sec-h">
        <h2>3) Missing Values</h2>
        <div class="hint">% missing per column</div>
      </div>
      <div class="sec-b">
        <div class="canvas-wrap">
          <canvas id="missingChart" height="220"></canvas>
        </div>
        <div class="table-wrap" style="margin-top:12px">
          <table id="missingTable">
            <thead></thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
    </section>

    <!-- Stats Summary -->
    <section>
      <div class="sec-h">
        <h2>4) Stats Summary</h2>
        <div class="hint">Numeric + categorical + Survived group (train only)</div>
      </div>
      <div class="sec-b">
        <div class="two-cols">
          <div>
            <div class="small mono" style="margin-bottom:6px">Numeric summary</div>
            <div class="table-wrap">
              <table id="numericStatsTable">
                <thead></thead>
                <tbody></tbody>
              </table>
            </div>
          </div>
          <div>
            <div class="small mono" style="margin-bottom:6px">Categorical counts (top 10 per column)</div>
            <div class="table-wrap">
              <table id="categoricalTable">
                <thead></thead>
                <tbody></tbody>
              </table>
            </div>
          </div>
        </div>

        <div style="margin-top:12px">
          <div class="small mono" style="margin-bottom:6px">Train-only: group by Survived (means for numeric)</div>
          <div class="table-wrap">
            <table id="groupBySurvivedTable">
              <thead></thead>
              <tbody></tbody>
            </table>
          </div>
        </div>
      </div>
    </section>
  </div>

  <!-- Visualizations -->
  <section>
    <div class="sec-h">
      <h2>5) Visualizations</h2>
      <div class="hint">Bars, histograms, correlation “heatmap”</div>
    </div>
    <div class="sec-b">
      <div class="grid-2">
        <div class="canvas-wrap"><canvas id="barSex" height="210"></canvas></div>
        <div class="canvas-wrap"><canvas id="barPclass" height="210"></canvas></div>
        <div class="canvas-wrap"><canvas id="barEmbarked" height="210"></canvas></div>
        <div class="canvas-wrap"><canvas id="histAge" height="210"></canvas></div>
        <div class="canvas-wrap"><canvas id="histFare" height="210"></canvas></div>
        <div class="canvas-wrap"><canvas id="corrHeatmap" height="260"></canvas></div>
      </div>
      <div class="small" style="margin-top:10px">
        Correlation is computed on numeric columns (train+test combined) after dropping missing values pairwise.
      </div>
    </div>
  </section>

  <!-- Export -->
  <section>
    <div class="sec-h">
      <h2>6) Export</h2>
      <div class="hint">Merged CSV + JSON summary</div>
    </div>
    <div class="sec-b">
      <div class="small">
        Use the export buttons in “Data Load” after EDA is run. CSV export includes the added <code>source</code> column.
        JSON export includes shape, missingness, numeric stats, categorical counts, and correlations.
      </div>
    </div>
  </section>
</main>

<div class="footer">
  Tip: This is intentionally “dumb deployable” (no build step, no server). Everything runs in your browser. The universe remains weird.
</div>

<script src="app.js"></script>
</body>
</html>
